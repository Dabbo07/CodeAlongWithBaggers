#program testgame   5 LAYER 2,0: LAYER 0: CLS : PRINT "Saving game..."  10 SAVE "testgame.bas"  11 .bas2txt testgame.bas  15 PRINT "Done."  20 RUN AT 3  30 GO SUB 1000: REM setup  40 GO SUB 2000: REM menu  50 GO SUB 3000: REM game setup  60 GO SUB 4000: REM game loop  70 GO SUB 5000: REM game over  80 GO TO 401000 REM setup1010 LAYER 2,0: SPRITE CLEAR : CLS 1020 LET tempbank=141030 LET tilemapbank=151040 LOAD "img/tiles.spr" BANK tempbank1050 SPRITE BANK tempbank1060 LOAD "img/block.spr" BANK tempbank1070 TILE BANK tempbank1080 RESTORE 13001090 LET ptr=01100 READ a1110 IF a=255 THEN GO TO 15001120 BANK tilemapbank POKE ptr,a1130 LET ptr=ptr+11140 GO TO 11001300 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,11310 DATA 1,0,0,0,1,1,1,0,0,0,0,0,0,0,0,11320 DATA 1,0,1,0,1,5,1,1,1,1,1,5,1,1,0,11330 DATA 1,0,1,0,0,0,0,0,0,0,1,0,1,0,0,11340 DATA 1,0,1,1,1,1,1,1,0,0,1,0,1,0,1,11350 DATA 1,0,1,0,0,0,0,0,0,0,1,0,4,0,0,11360 DATA 1,0,1,0,1,5,1,1,1,0,1,1,1,1,0,11370 DATA 1,0,1,0,1,0,1,0,0,0,1,0,4,0,0,11380 DATA 1,0,1,0,0,0,1,0,1,1,1,0,1,1,0,11390 DATA 1,0,1,1,1,1,1,0,0,0,1,0,1,1,0,11400 DATA 1,0,0,0,0,5,0,0,1,0,0,0,1,1,3,11410 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,11420 DATA 2551500 TILE DIM tilemapbank,0,16,161510 LOAD "img/levels.spr" BANK tilemapbank1590 RETURN 2000 REM menu2010 PAPER 0: BORDER 0: INK 7: LAYER 2,0: LAYER 0: CLS 2020 PRINT AT 11,5;"Press a key to start"2030 PAUSE 02990 RETURN 3000 REM game setup3010 CLS : LAYER 2,0: GO SUB 1080: TILE AT 0,0: LAYER 2,13020 LET px=32+16+83030 LET py=32+192-32+83040 LET pp=03050 LET pf=13060 SPRITE PRINT 13070 LET sc=03990 RETURN 4000 REM game4010 PAUSE 14020 GO SUB 6000: REM handlePlayer4030 PRINT AT 23,12;"SCR ";sc4980 IF pp<>63 THEN GO TO 40004990 RETURN 5000 REM game over5010 SPRITE PRINT 05020 LAYER 2,0: LAYER 0: CLS 5030 PRINT AT 1,1;"Game over!"5040 PAUSE 05990 RETURN 6000 REM handlePlayer6010 SPRITE 0,px-8,py-14,pp,pf6020 LET ox=px: LET oy=py: LET pa=0: LET dx=0: LET dy=06030 IF %( IN $fbfe & 1)=0 THEN LET py=py-1: LET pa=1: LET dy=-16040 IF %( IN $fdfe & 1)=0 THEN LET py=py+1: LET pa=1: LET dy=16050 IF %( IN $dffe & 2)=0 THEN LET px=px-1: LET pa=1: LET dx=-16060 IF %( IN $dffe & 1)=0 THEN LET px=px+1: LET pa=1: LET dx=16070 LET tx=px: LET ty=py: GO SUB 70006080 IF pa=1 THEN LET pp=pp+1: IF pp=2 THEN LET pp=06090 IF %r=1 THEN LET px=ox: LET py=oy: LET pp=0 6100 IF %r=3 THEN LET pp=63: RETURN 6110 IF %r=5 THEN LET sc=sc+100: GO SUB 7100 6990 RETURN 7000 REM collisionDetection7010 LET %x= INT ((tx-32)/16): LET %y= INT ((ty-32)/16): LET %b= INT (tilemapbank)7020 LET %r=% BANK b PEEK (y*16+x)7030 RETURN 7100 REM tileRemove7110 LET %x= INT ((tx-32)/16): LET %y= INT ((ty-32)/16) 7120 BANK %b POKE %(y*16+x),0 7130 TILE AT 0,07140 RETURN 